{% extends "base.html" %}
{% load static %}

{% block title %}Products | ShopSmart{% endblock %}
{% block header_title %}Products{% endblock %}

{% block content %}
<div class="products-container">
    <!-- Search Bar -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="get" class="search-form">
                <div class="input-group">
                    <input type="text" name="search" class="form-control" placeholder="Search products..." value="{{ search_term }}">
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="submit">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                                <path fill="none" d="M0 0h24v24H0z"/>
                                <path d="M18.031 16.617l4.283 4.282-1.415 1.415-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9 9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15z" fill="currentColor"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Products List -->
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h2 class="card-title mb-0">All Products</h2>
            <a href="{% url 'groceries:create_item' %}" class="btn btn-sm btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" class="mr-1">
                    <path fill="none" d="M0 0h24v24H0z"/>
                    <path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z" fill="currentColor"/>
                </svg>
                Add Product
            </a>
        </div>
        <div class="card-body p-0">
            {% if items %}
                <div class="list-group list-group-flush">
                    {% for item in items %}
                        <div class="list-group-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="item-info">
                                    <h3 class="h5 mb-0">{{ item.name }}</h3>
                                    {% if item.brand %}
                                        <small class="text-muted">{{ item.brand }}</small>
                                    {% endif %}
                                </div>
                                <div class="item-actions">
                                    <a href="{% url 'groceries:item_store_locations' pk=item.id %}" class="btn btn-sm btn-outline mr-2" title="Manage Store Locations">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                                            <path fill="none" d="M0 0h24v24H0z"/>
                                            <path d="M17.657 15.657L12 21.314l-5.657-5.657a8 8 0 1 1 11.314 0zM12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" fill="currentColor"/>
                                        </svg>
                                        Store Locations
                                    </a>
                                    <a href="{% url 'groceries:edit_item' pk=item.id %}" class="btn btn-sm btn-outline" title="Edit Item">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                                            <path fill="none" d="M0 0h24v24H0z"/>
                                            <path d="M12.9 6.858l4.242 4.243L7.242 21H3v-4.243l9.9-9.9zm1.414-1.414l2.121-2.122a1 1 0 0 1 1.414 0l2.829 2.829a1 1 0 0 1 0 1.414l-2.122 2.121-4.242-4.242z" fill="currentColor"/>
                                        </svg>
                                        Edit
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <!-- Pagination -->
                {% if is_paginated %}
                <div class="pagination-container mt-3 p-3">
                    <ul class="pagination justify-content-center">
                        {% if page_obj.has_previous %}
                            <li class="page-item">
                                <a class="page-link" href="?page=1{% if search_term %}&search={{ search_term }}{% endif %}" aria-label="First">
                                    <span aria-hidden="true">&laquo;&laquo;</span>
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_term %}&search={{ search_term }}{% endif %}" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                        {% endif %}
                        
                        {% for num in page_obj.paginator.page_range %}
                            {% if page_obj.number == num %}
                                <li class="page-item active">
                                    <a class="page-link" href="?page={{ num }}{% if search_term %}&search={{ search_term }}{% endif %}">{{ num }}</a>
                                </li>
                            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                                <li class="page-item">
                                    <a class="page-link" href="?page={{ num }}{% if search_term %}&search={{ search_term }}{% endif %}">{{ num }}</a>
                                </li>
                            {% endif %}
                        {% endfor %}
                        
                        {% if page_obj.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_term %}&search={{ search_term }}{% endif %}" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if search_term %}&search={{ search_term }}{% endif %}" aria-label="Last">
                                    <span aria-hidden="true">&raquo;&raquo;</span>
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
                {% endif %}
            {% else %}
                <div class="empty-state text-center p-5">
                    <div class="empty-state-icon mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="64" height="64">
                            <path fill="none" d="M0 0h24v24H0z"/>
                            <path d="M20 22H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1zm-1-2V4H5v16h14zM9 6v2a3 3 0 0 0 6 0V6h2v2A5 5 0 0 1 7 8V6h2z" fill="currentColor"/>
                        </svg>
                    </div>
                    <h3>No Products Found</h3>
                    <p class="text-muted mb-4">No products match your search criteria.</p>
                    {% if search_term %}
                        <a href="{% url 'groceries:items' %}" class="btn btn-outline">View All Products</a>
                    {% else %}
                        <a href="{% url 'groceries:create_item' %}" class="btn btn-primary">Add Your First Product</a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .item-info {
        flex: 1;
    }
    
    .list-group-item {
        transition: background-color 0.2s;
    }
    
    .list-group-item:hover {
        background-color: var(--bg-secondary);
    }
    
    .search-form {
        width: 100%;
    }
    
    .empty-state-icon {
        color: var(--text-tertiary);
    }
    
    .empty-state h3 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }
    
    .item-actions {
        white-space: nowrap;
    }
    
    .pagination-container {
        border-top: 1px solid var(--border-light);
    }
</style>
{% endblock %}